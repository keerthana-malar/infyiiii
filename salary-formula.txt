balance = user.userbalance;
workingdays = user.workingdays;
basicsalary = user.basicsalary;
leaveTaken = user.leavetaken;
name = user.userName;

$per_id = array\at(user.empMpsIds, 0);


ifThen(
    month == 'January' ||
    month == 'March' ||
    month == 'May' ||
    month == 'July' ||
    month == 'August' ||
    month == 'October' ||
    month == 'December',
    totalsalary = (basicsalary/31) * workingdays + incentive - balance
);

ifThen(
    month == 'April' ||
    month == 'June' || 
    month == 'September' ||
    month =='November', 
    
    totalsalary = (basicsalary/30) * workingdays + incentive - balance
    );
    
ifThen(
    month == 'February' && leapyear == 'Yes', 
    totalsalary = (basicsalary/29) * workingdays + incentive - balance
);

ifThen(
    month == 'February' && leapyear == 'No', 
    totalsalary = (basicsalary/28) * workingdays + incentive - balance
);
    
ifThen(
    salarystatus == 'approved' && final == true,
        record\update('User', userId , 
        'workingdays' , 0,
        'userbalance' , 0,
        'advance', 0,
        'expense', 0,
        'leavetaken' , 0,
        'overtime', 0,
        'latetime', 0,
        'yearlysalary', user.yearlysalary + totalsalary,
        'salary', totalsalary,
        'yearlyincentive', user.yearlyincentive + incentive,
        'incentive', incentive
    );
    record\update("EmpMp",$per_id, 
    'salary', totalsalary, 
    'incentive', incentive
    )
);

ifThen(
    salarystatus == 'approved' && final == true && month == 'December',
    record\update('User', userId ,
    'yearlyworkingdays' , 0,
    'leavetakenyearly', 0,
    'yearlypermissiontime', 0,
    'overtimeyearly', 0,
    'latetimeyearly', 0,
    )
);

